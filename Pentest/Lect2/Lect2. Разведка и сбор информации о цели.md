### Поиск TLD(+1)

> TLD - top level doman

Пример: www.example.com 
- поддомен: **www**
- домен второго уровня (TLD+1): **example**
- домен верхнего уровня (TLD): **com**

Утилита: **whois**

![[../Lect1/Materials/Pasted image 20250913100703.jpeg|649x390]]
`whois -H example.com` - информация по тому, кто зарегистрировал домен (организация), когда обновлен, url и т.д.

утилиты по доменам 1 уровня: 
- dnsrecon
	- `dnsrecon -t tld example.com`
	- большой риск FP
- crobat (старая)
	- `crobat -t example.com`
	- большой риск FP
- amass
	- `amass intel -whois -df tld.txt`

> **SSL (certificate transparency)** - проект, согласно которому CA обзаны публиковать информацию о каждом выпущенном сертификате.

Делаем поиск по выпущенным SSL сертификатам компании:
```
https://crt.sh/?o=organization+name
https://crt.sh/?q=example.com
https://crt.sh/?a=1
```

### Получение информации от NS

> DNS - domain name server

Основные виды записей:
- A: IPv4
- AAAA: IPv6
- CNAME: алиас на другой домен
- MX: доменное имя почтового сервера
- **NS: список серверов, ответственных за разрешение доменных имëн (Name Servers)**
- PTR: используется для обратной связи (IP -> доменное имя)
- TXT: текстовое поле

Zone Transfer
- Репликация DNS-записей с одного NS-сервера на другой
- Осуществляется при помощи AXFR запросов
- Если имеется миссконфигурация, выполнить данную операцию может кто угодно
- **ВАЖНО! Это шумная операция**
```
dig axfr @ns.server.domain target.domain
host -I target.domain ns.server.domain
dnsrecon -a -d "target.domain"
```

Reverse NS Lookup
- поиск доменов, использующих конкретный NS
- В некоторых случаях позволяет получить список поддоменов
```
https://viewdns.info/reversens/?ns=ns.server.domain
```

### Поиск поддоменов

##### Утилиты:

- zdns
- altdns
- dnsx
- shuffledns
- gobuster
- ffuf
- dnsrecon
	- `dnsrecon -d "target.domain"`
- crobat (устар)
	- `crobat -s example.com`
- amass 
	- `amass enum -passive -df tld.txt -config your.config`
	- `amass enum -passive -norecursive -noalts -df tld.txt -config your.config`

##### SSL:

- findomain
	- `findomain -t "target.domain" -a`
- subfinder
	- `subfinder -d "target.domain"`
- assetfinder
	- `assetfinder "target.domain"`

##### API

Можно использовать API Следующих сервисов:
```
AlienVault, BinaryEdge, BufferOver, BuiltWith, C99, Censys, Chaos, CIRCL, DNSDB, DNSTable, FacebookCT, GitHub, HackerOne, HackerTarget, NetworksDB, PassiveTotal, RapidDNS, Riddler, SecurityTrails, Shodan, SiteDossier, Spyse, Twitter, Umbrella, URLScan, VirusTotal, WhoisXML, ZETAlytics, Cloudflare
```
Имеется интеграция данных сервисов с amass с указанием API-ключа

##### Shodan

> Shodan - поисковая система, позволяющая пользователям искать различные типы серверов веб-камеры, с использованием различных фильтров. Некоторые также описывают её как поисковую систему сервисных баннеров, представляющие собой метаданные, которые сервер отправляет обратно клиенту. Этими метаданными могут быть информация о серверном программном обеспечении, какие опции поддерживает сервис, приветственное сообщение или что-то ещё, что клиент должен выяснить перед взаимодействием с сервером.

- [shodan]((https://www.shodan.io/)
	- `hostname:"target.domain"`
- [nrich](https://www.shodan.io/) = cli shodan
	- `echo 127.0.0.1 | nrich -`
	- `nrich ip_list.txt`
в некоторых случаях можно получить имеющиеся уязвимости

##### Sundomain brute-forcing

1. Получение списка резолверов (NS-серверов), также можно использовать собственные ns-сервера компании
	```
	wget https://raw.githubusercontent.com/wavvs/lazydns/master/resolvers.txt
	```
2. Получение списка потенциальных поддоменов
	```
	https://github.com/assetnote/commonspeak2-wordlists/blob/master/subdomains/subdomains.txt
	https://github.com/danielmiessler/SecLists/blob/master/Discovery/DNS/dns-Jhaddix.txt
	https://github.com/wavvs/lazydns/blob/master/wordlists/normal.txt
	https://github.com/wavvs/lazydns/tree/master/wordlists/big.txt
	```
3. Запуск перебора (zdns)
	```
	zdns A --name-servers=@resolvers.txt -input-file wordlist.txt -threads 50 -retries 3 -go-processes 5 | tee result_A.json 
	zdns CNAME --name-servers=@resolvers.txt -input-file wordlist.txt -threads 50 -retries 3 -go-processes 5 | tee result_CNAME.json
	zdns AAAA --name-servers=@resolvers.txt -input-file wordlist.txt -threads 50 -retries 3 -go-processes 5 | tee result_AAAA.json
	```
1. Поиск изменённых доменных имён для обнаруженных доменов (altdns)
2. Разрешение (Resolve) доменных имён

Фильтрация
wildcard domains:
dns-запись вида \*.example.com A 127.0.0.1

быстрая проверка на wildcard domains через dig

Замечания:
- в некоторых конфигах разрешен wildcard-домен, однако не будет ответа на запрос \*.example.com
- В некоторых конфигурациях будет исполь...

проверка с помощью dnsx

Утилиты считают количество доменов, которые разрешаются в один и тот же IP-адрес
При преодолении лимита домены будут проверяться на wildcard

### Виртуальные хосты
Vhost

![[../Lect1/Materials/Pasted image 20250913102301.jpeg]]

Утилиты:
- Burp 
- ffuf
- wfuxx 
- gobuster

### Поиск подсетей

онлайн-поиск: через 
![[../Lect1/Materials/Pasted image 20250913102533.jpeg]]

ptr-записи: 
dnsrecon -r 127.0.0.1/24 -d
amas intel -ip -addr 127.0.0.1.
amas ...

Базы данных Forward DNS (FDNS)
crobat -r 127.0.0.1/24
amass intel -addr 127.0.0.1
amass intel -cidr 127.0.0.1/24
amsss intel ...

### Поиск сервисов

- nmap
- masscan

главное различие в скорости и точности (nmap медленнее, но точнее)

Поиск веб-приложений
- httpx
- httprobe

Визуальное отображение веб-приложений

aquatone
WitnessMe
EyeWitness

cat http_subdomains.txt | aquatone
cat ...

### Поиск директорий веб-приложений

- gau
- waybackurls

Фаззинг (Fuzzing)
- gobuster
- ffuf
- dirsearch
- dirb
- dirbuster
- wfuzz
- feroxbuster

**ВАЖНО! Фаззинг часто может вызвать отказ в обслуживании (DoS) из-за большого количества запросов в секунду (особенно ffuf и feroxbuster), поэтому скорость работы утилит нужно ограничивать**

Fuzzing Wordlists
![[../Lect1/Materials/Pasted image 20250913103240.jpeg]]

### Определение стека технологий

утилиты:
- whatweb
- wappalyzer - расширение
![[../Lect1/Materials/Pasted image 20250913103402.jpeg]]

Определение языка программирования по расширению файла
- .php -> php
- .aspx -> C#
- .asp -> VBScript
- .isp, .jspx, .do -> java
- .pl -> Perl
- .py -> Python
- ...

Google Dorks
- <<>> - поиск вхождения
- -test - исключение страниц, содержащих "test"
- site:example.com - поиск только по доменам site.com
- inurl:keyword - поиск по кейвордам
- filetype:xls - поиск по расширениям
- и др

site:\*.target.domain -www -> поиск поддоменов, исключая уже найденные (www)

Cloud discovery
- s3revon
- grayhatwarware

На что еще обращаем внимание?
- Информация на странице (Секции credits, contacts)
- нестандартные http заголовки
- файлы robots.txt, sitemap.xml, .DS_Strore, ...
- Комментарии и метаданные (HTML-, CSS-, JS-файлы)
- Логи ошибок (StackTrace)

Бонус: определение веб-сервера по стандартной ошибке 404
![[../Lect1/Materials/Pasted image 20250913104348.jpeg|649x630]]

